"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[82],{82:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(379),n=a(43),l=a(352),i=a(269),r=a(90),o=a(770),c=a(732),d=a(579);const m=()=>{const[e,s]=(0,n.useState)([]),[a,m]=(0,n.useState)(""),[h,u]=(0,n.useState)(!1),[g,x]=(0,n.useState)(!0),[v,p]=(0,n.useState)("gpt-4o"),[j,f]=(0,n.useState)([]),N=(0,n.useRef)(null),b=(0,n.useRef)(null),w=(0,l.Zp)();(0,n.useEffect)(()=>{e.length>0&&(()=>{var e;null===(e=N.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[e]),(0,n.useEffect)(()=>{b.current&&(b.current.style.height="auto",b.current.style.height=Math.min(b.current.scrollHeight,200)+"px")},[a]);const y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if(!e||0===e.trim().length||h)return;const n={role:"user",content:e.trim(),timestamp:new Date};s(e=>[...e,n]);const l=[...j,{role:"user",content:e.trim()}];f(l),m(""),u(!0),x(!1);const i=Date.now(),r={id:i,role:"assistant",content:"",timestamp:new Date,isStreaming:!0};s(e=>[...e,r]);try{const a=await fetch("".concat(c.A,"/ai-assistant/stream"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({prompt:e.trim(),model:v,conversationHistory:l.slice(-10)})});if(401===a.status)return void(window.location.href="/#/");if(!a.ok)throw new Error("HTTP error! status: ".concat(a.status));const n=a.body.getReader(),r=new TextDecoder;let d="",m=null;for(;;){const{value:e,done:a}=await n.read();if(a)break;const l=r.decode(e,{stream:!0}).split("\n");for(const n of l)if(n.startsWith("data: ")){const e=n.slice(6);if("[DONE]"===e)continue;try{const a=JSON.parse(e);if(a.content&&(d+=a.content,s(e=>e.map(e=>e.id===i?(0,t.A)((0,t.A)({},e),{},{content:d}):e))),a.testGenerated&&(m=a.testData),a.error)throw new Error(a.error)}catch(o){console.warn("Parse error:",o)}}}s(e=>e.map(e=>{var s;return e.id===i?(0,t.A)((0,t.A)({},e),{},{isStreaming:!1,testGenerated:!!m,testArea:null===(s=m)||void 0===s?void 0:s.thematicArea}):e})),f(e=>[...e,{role:"assistant",content:d}])}catch(d){console.error("\u274c Errore AI:",d),s(e=>e.map(e=>e.id===i?(0,t.A)((0,t.A)({},e),{},{content:"\u274c Errore: ".concat(d.message||"Connessione fallita","\n\nProva a:\n\u2022 Verificare la connessione\n\u2022 Riformulare la richiesta\n\u2022 Ridurre la lunghezza del messaggio"),isStreaming:!1,isError:!0}):e))}finally{u(!1)}};return(0,d.jsxs)("div",{className:"ai-assistant-page",children:[(0,d.jsx)(r.A,{}),(0,d.jsx)(o.A,{variant:"floating",color:"purple"}),(0,d.jsx)(i.A,{}),(0,d.jsxs)("div",{className:"ai-container",children:[(0,d.jsxs)("div",{className:"ai-header",children:[(0,d.jsx)("h1",{children:"AI Assistant"}),(0,d.jsx)("button",{className:"clear-btn",onClick:()=>{window.confirm("Vuoi cancellare tutta la cronologia della chat?")&&(s([]),f([]),x(!0))},disabled:0===e.length,children:"Clear"})]}),(0,d.jsxs)("div",{className:"chat-container",children:[(0,d.jsxs)("div",{className:"messages-area",children:[e.map((a,t)=>(0,d.jsxs)("div",{className:"message ".concat(a.role," ").concat(a.isError?"error":""),children:[(0,d.jsxs)("div",{className:"message-content",children:[a.content,a.isStreaming&&(0,d.jsx)("span",{className:"cursor",children:"|"})]}),"assistant"===a.role&&!a.isStreaming&&(0,d.jsxs)("div",{className:"message-actions",children:[(0,d.jsx)("button",{onClick:()=>{return e=a.content,void navigator.clipboard.writeText(e);var e},children:"Copy"}),(0,d.jsx)("button",{onClick:()=>(async a=>{if(a<1)return;const t=e[a-1];"user"===t.role&&(s(e=>e.slice(0,a)),f(e=>e.slice(0,a)),y(t.content))})(t),children:"Regenerate"})]}),a.testGenerated&&(0,d.jsx)("button",{className:"test-btn",onClick:()=>w("/dashboard"),children:"View Test"})]},t)),h&&(0,d.jsx)("div",{className:"message assistant",children:(0,d.jsx)("div",{className:"message-content",children:(0,d.jsxs)("div",{className:"typing",children:[(0,d.jsx)("span",{}),(0,d.jsx)("span",{}),(0,d.jsx)("span",{})]})})}),(0,d.jsx)("div",{ref:N})]}),g&&0===e.length&&(0,d.jsx)("div",{className:"suggestions",children:["Storia: Seconda Guerra Mondiale","Matematica: Equazioni di secondo grado","Geografia: Capitali europee","Biologia: Corpo umano"].slice(0,4).map((e,s)=>(0,d.jsx)("button",{className:"suggestion",onClick:()=>(e=>{m(e),y(e)})(e),children:e},s))}),(0,d.jsxs)("div",{className:"input-area",children:[(0,d.jsxs)("select",{value:v,onChange:e=>p(e.target.value),disabled:h,children:[(0,d.jsx)("option",{value:"gpt-4o",children:"GPT-4o"}),(0,d.jsx)("option",{value:"gpt-4o-mini",children:"GPT-4o Mini"}),(0,d.jsx)("option",{value:"o1-preview",children:"O1 Preview"})]}),(0,d.jsx)("textarea",{ref:b,placeholder:"Message AI...",value:a,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},rows:1,disabled:h}),(0,d.jsx)("button",{className:"send-btn",onClick:()=>y(),disabled:h||!a.trim(),children:h?"...":"\u2192"})]})]})]})]})}},90:(e,s,a)=>{a.d(s,{A:()=>i});var t=a(43),n=a(579);const l=(0,t.memo)(()=>(0,n.jsx)("div",{className:"page-bg-wrapper","aria-hidden":"true",children:(0,n.jsx)("img",{className:"page-bg",src:"/sfondo_pages.jpg",alt:"",loading:"lazy"})}));l.displayName="PageBackground";const i=l},269:(e,s,a)=>{a.d(s,{A:()=>d});var t=a(43),n=a(352),l=a(930),i=a(496),r=a(711),o=a(579);const c=(0,t.memo)(()=>{const e=(0,n.Zp)(),s=(0,n.zy)(),{theme:a,toggleTheme:t}=(0,i.D)(),{t:c}=(0,l.Bd)(),d=e=>s.pathname===e||s.pathname.startsWith(e);return(0,o.jsxs)("div",{className:"dashboard-topbar",children:[(0,o.jsx)("button",{className:"topbar-btn".concat(d("/dashboard")?" active":""),onClick:()=>e("/dashboard"),children:c("topbar.home")}),(0,o.jsx)("button",{className:"topbar-btn".concat(d("/ai-assistant")?" active":""),onClick:()=>e("/ai-assistant"),children:c("topbar.aiAssistant")}),(0,o.jsx)("button",{className:"topbar-btn".concat(d("/statistiche")?" active":""),onClick:()=>e("/statistiche"),children:c("topbar.statistics")}),(0,o.jsx)(r.A,{}),(0,o.jsx)("button",{className:"theme-toggle-btn",onClick:t,"aria-label":c("landing.changeTheme"),title:c("light"===a?"landing.darkTheme":"landing.lightTheme"),children:"light"===a?"\ud83c\udf19":"\u2600\ufe0f"})]})});c.displayName="Topbar";const d=c},770:(e,s,a)=>{a.d(s,{A:()=>n});a(43);var t=a(579);function n(e){let{variant:s="corner",color:a="blue"}=e;const n=()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"led-corner led-top-left led-".concat(a),children:[(0,t.jsx)("div",{className:"led-dot"}),(0,t.jsx)("div",{className:"led-line led-line-horizontal"}),(0,t.jsx)("div",{className:"led-line led-line-vertical"})]}),(0,t.jsxs)("div",{className:"led-corner led-top-right led-".concat(a),children:[(0,t.jsx)("div",{className:"led-dot"}),(0,t.jsx)("div",{className:"led-line led-line-horizontal"}),(0,t.jsx)("div",{className:"led-line led-line-vertical"})]}),(0,t.jsxs)("div",{className:"led-corner led-bottom-left led-".concat(a),children:[(0,t.jsx)("div",{className:"led-dot"}),(0,t.jsx)("div",{className:"led-line led-line-horizontal"}),(0,t.jsx)("div",{className:"led-line led-line-vertical"})]}),(0,t.jsxs)("div",{className:"led-corner led-bottom-right led-".concat(a),children:[(0,t.jsx)("div",{className:"led-dot"}),(0,t.jsx)("div",{className:"led-line led-line-horizontal"}),(0,t.jsx)("div",{className:"led-line led-line-vertical"})]})]}),l=()=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"led-floating led-float-1 led-".concat(a)}),(0,t.jsx)("div",{className:"led-floating led-float-2 led-".concat(a)}),(0,t.jsx)("div",{className:"led-floating led-float-3 led-".concat(a)}),(0,t.jsx)("div",{className:"led-floating led-float-4 led-".concat(a)}),(0,t.jsx)("div",{className:"led-floating led-float-5 led-".concat(a)})]});return(0,t.jsxs)("div",{className:"led-effect-container",children:["corner"===s&&n(),"floating"===s&&l(),"border"===s&&(0,t.jsxs)("div",{className:"led-border-container led-".concat(a),children:[(0,t.jsxs)("svg",{className:"led-border-svg",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[(0,t.jsx)("defs",{children:(0,t.jsxs)("linearGradient",{id:"ledGrad-".concat(a),x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,t.jsx)("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0",children:(0,t.jsx)("animate",{attributeName:"stop-opacity",values:"0;0.8;0",dur:"3s",repeatCount:"indefinite"})}),(0,t.jsx)("stop",{offset:"50%",stopColor:"currentColor",stopOpacity:"0.8",children:(0,t.jsx)("animate",{attributeName:"stop-opacity",values:"0.3;1;0.3",dur:"3s",repeatCount:"indefinite"})}),(0,t.jsx)("stop",{offset:"100%",stopColor:"currentColor",stopOpacity:"0",children:(0,t.jsx)("animate",{attributeName:"stop-opacity",values:"0;0.8;0",dur:"3s",repeatCount:"indefinite"})})]})}),(0,t.jsx)("rect",{x:"0",y:"0",width:"100",height:"100",fill:"none",stroke:"url(#ledGrad-".concat(a,")"),strokeWidth:"0.5",className:"led-border-rect"})]}),(0,t.jsx)("div",{className:"led-corner-glow led-corner-glow-tl"}),(0,t.jsx)("div",{className:"led-corner-glow led-corner-glow-tr"}),(0,t.jsx)("div",{className:"led-corner-glow led-corner-glow-bl"}),(0,t.jsx)("div",{className:"led-corner-glow led-corner-glow-br"})]}),"full"===s&&(0,t.jsxs)(t.Fragment,{children:[n(),l()]})]})}}}]);
//# sourceMappingURL=82.079e1140.chunk.js.map
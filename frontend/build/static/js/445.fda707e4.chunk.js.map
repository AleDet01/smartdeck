{"version":3,"file":"static/js/445.fda707e4.chunk.js","mappings":"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","sources":["components/PageBackground.jsx","components/Topbar.jsx","utils/hooks.js","pages/PreTestPage.jsx"],"sourcesContent":["import { memo } from 'react';\r\n\r\nconst PageBackground = memo(() => (\r\n  <div className=\"page-bg-wrapper\" aria-hidden=\"true\">\r\n    <img className=\"page-bg\" src={process.env.PUBLIC_URL + '/sfondo_pages.jpg'} alt=\"\" loading=\"lazy\" />\r\n  </div>\r\n));\r\n\r\nPageBackground.displayName = 'PageBackground';\r\n\r\nexport default PageBackground;\r\n","import { memo, useCallback } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useTheme } from '../utils/themeContext';\r\nimport LanguageSelector from './LanguageSelector';\r\nimport '../css/Topbar.css';\r\n\r\nconst Topbar = memo(() => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { theme, toggleTheme } = useTheme();\r\n  const { t } = useTranslation();\r\n  \r\n  const isActive = (path) => location.pathname === path || location.pathname.startsWith(path);\r\n  \r\n  return (\r\n    <div className=\"dashboard-topbar\">\r\n      <button \r\n        className={`topbar-btn${isActive('/dashboard') ? ' active' : ''}`} \r\n        onClick={() => navigate('/dashboard')}\r\n      >\r\n        {t('topbar.home')}\r\n      </button>\r\n      <button \r\n        className={`topbar-btn${isActive('/ai-assistant') ? ' active' : ''}`} \r\n        onClick={() => navigate('/ai-assistant')}\r\n      >\r\n        {t('topbar.aiAssistant')}\r\n      </button>\r\n      <button \r\n        className={`topbar-btn${isActive('/statistiche') ? ' active' : ''}`} \r\n        onClick={() => navigate('/statistiche')}\r\n      >\r\n        {t('topbar.statistics')}\r\n      </button>\r\n      \r\n      <LanguageSelector />\r\n      \r\n      <button \r\n        className=\"theme-toggle-btn\"\r\n        onClick={toggleTheme}\r\n        aria-label={t('landing.changeTheme')}\r\n        title={theme === 'light' ? t('landing.darkTheme') : t('landing.lightTheme')}\r\n      >\r\n        {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}\r\n      </button>\r\n    </div>\r\n  );\r\n});\r\n\r\nTopbar.displayName = 'Topbar';\r\n\r\nexport default Topbar;\r\n","import { useEffect, useState, useMemo } from 'react';\r\nimport API_HOST from './apiHost';\r\n\r\nexport const useFetch = (url, options = {}) => {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Memoizza options per evitare re-fetch inutili\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  const memoizedOptions = useMemo(() => options, [JSON.stringify(options)]);\r\n\r\n  useEffect(() => {\r\n    if (!url) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    \r\n    (async () => {\r\n      try {\r\n        const res = await fetch(url, { \r\n          ...memoizedOptions, \r\n          signal: controller.signal,\r\n          credentials: memoizedOptions.credentials || 'include'\r\n        });\r\n        \r\n        // Se sessione scaduta (401), reindirizza al login\r\n        if (res.status === 401) {\r\n          console.log('üîí Sessione scaduta, reindirizzamento al login...');\r\n          window.location.href = '/#/';\r\n          return;\r\n        }\r\n        \r\n        if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n        const json = await res.json();\r\n        setData(json);\r\n        setError(null);\r\n      } catch (err) {\r\n        if (err.name !== 'AbortError') {\r\n          setError(err);\r\n          setData(null);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n\r\n    return () => controller.abort();\r\n  }, [url, memoizedOptions]);\r\n\r\n  return { data, loading, error };\r\n};\r\n\r\n\r\nexport const useCurrentUser = () => {\r\n  const { data, loading } = useFetch(`${API_HOST}/auth/me`);\r\n  return {\r\n    user: data?.user || null,\r\n    authenticated: data?.authenticated || false,\r\n    loading\r\n  };\r\n};\r\n\r\nexport const useAdaptiveFontSize = (selector, deps = []) => {\r\n  useEffect(() => {\r\n    if (deps.some(d => !d)) return;\r\n\r\n    const MIN_PX = 12, STEP_PX = 1;\r\n    \r\n    const adjustAll = () => {\r\n      const nodes = Array.from(document.querySelectorAll(selector));\r\n      nodes.forEach(node => {\r\n        node.style.fontSize = '';\r\n        const containerWidth = node.clientWidth;\r\n        let fontPx = parseFloat(window.getComputedStyle(node).fontSize) || 16;\r\n        \r\n        const fits = () => node.scrollWidth <= containerWidth + 1;\r\n        let safety = 100;\r\n        \r\n        while (!fits() && fontPx > MIN_PX && safety-- > 0) {\r\n          fontPx = Math.max(MIN_PX, fontPx - STEP_PX);\r\n          node.style.fontSize = fontPx + 'px';\r\n        }\r\n      });\r\n    };\r\n\r\n    let raf = requestAnimationFrame(() => setTimeout(adjustAll, 0));\r\n    const onResize = () => {\r\n      if (raf) cancelAnimationFrame(raf);\r\n      raf = requestAnimationFrame(() => setTimeout(adjustAll, 0));\r\n    };\r\n\r\n    window.addEventListener('resize', onResize);\r\n    const retry = setTimeout(adjustAll, 250);\r\n\r\n    return () => {\r\n      if (raf) cancelAnimationFrame(raf);\r\n      window.removeEventListener('resize', onResize);\r\n      clearTimeout(retry);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, deps);\r\n};\r\n","import { useState, useMemo } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Topbar from '../components/Topbar';\r\nimport PageBackground from '../components/PageBackground';\r\nimport '../css/PreTestPage.css';\r\nimport API_HOST from '../utils/apiHost';\r\nimport { useFetch } from '../utils/hooks';\r\n\r\nconst PreTestPage = () => {\r\n  const { area } = useParams();\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation();\r\n  const [numQuestions, setNumQuestions] = useState(10);\r\n  \r\n  const { data } = useFetch(`${API_HOST}/flash/thematic/${area}`);\r\n  const maxQuestions = data?.length || 20;\r\n\r\n  const quickPicks = useMemo(() => {\r\n    const base = [5, 10, 15, 20];\r\n    const list = base.filter(n => n <= maxQuestions);\r\n    return list.length === 0 ? [Math.min(5, maxQuestions)] : list;\r\n  }, [maxQuestions]);\r\n\r\n  const handleNumChange = (val) => {\r\n    const clamped = Math.max(1, Math.min(val, maxQuestions));\r\n    setNumQuestions(clamped);\r\n  };\r\n\r\n  return (\r\n    <div className=\"pretest-page\">\r\n      <PageBackground />\r\n      <Topbar />\r\n      <div className=\"pretest-card\">\r\n        <h2>{t('pretest.title')} <span className=\"accent\">{area}</span></h2>\r\n        <div className=\"quick-picks\" aria-label={t('pretest.quickSelect')}>\r\n          {quickPicks.map(n => (\r\n            <button\r\n              key={n}\r\n              className={n === numQuestions ? 'chip active' : 'chip'}\r\n              onClick={() => setNumQuestions(n)}\r\n              type=\"button\"\r\n            >\r\n              {n}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <label>\r\n          {t('pretest.numQuestions')} (max {maxQuestions}):\r\n          <input\r\n            type=\"number\"\r\n            min={1}\r\n            max={maxQuestions}\r\n            value={numQuestions}\r\n            onChange={e => handleNumChange(Number(e.target.value) || 0)}\r\n            className=\"modern-input\"\r\n          />\r\n        </label>\r\n        <button\r\n          className=\"modern-btn cta\"\r\n          onClick={() => navigate(`/test/${encodeURIComponent(area)}/${numQuestions}`)}\r\n          disabled={!maxQuestions || numQuestions < 1}\r\n          type=\"button\"\r\n        >\r\n          {t('pretest.startTest')}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PreTestPage;\r\n"],"names":["PageBackground","memo","_jsx","className","children","src","alt","loading","displayName","Topbar","navigate","useNavigate","location","useLocation","theme","toggleTheme","useTheme","t","useTranslation","isActive","path","pathname","startsWith","_jsxs","concat","onClick","LanguageSelector","title","useFetch","url","options","arguments","length","undefined","data","setData","useState","setLoading","error","setError","memoizedOptions","useMemo","JSON","stringify","useEffect","controller","AbortController","res","fetch","_objectSpread","signal","credentials","status","console","log","window","href","ok","Error","json","err","name","abort","useAdaptiveFontSize","selector","deps","some","d","adjustAll","Array","from","document","querySelectorAll","forEach","node","style","fontSize","containerWidth","clientWidth","fontPx","parseFloat","getComputedStyle","fits","scrollWidth","safety","Math","max","raf","requestAnimationFrame","setTimeout","onResize","cancelAnimationFrame","addEventListener","retry","removeEventListener","clearTimeout","PreTestPage","area","useParams","numQuestions","setNumQuestions","API_HOST","maxQuestions","quickPicks","list","filter","n","min","map","type","value","onChange","e","val","clamped","handleNumChange","Number","target","encodeURIComponent","disabled"],"sourceRoot":""}
{"version":3,"file":"static/js/82.079e1140.chunk.js","mappings":"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","sources":["pages/AIAssistantPage.jsx","components/PageBackground.jsx","components/Topbar.jsx","components/LEDEffect.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Topbar from '../components/Topbar';\r\nimport PageBackground from '../components/PageBackground';\r\nimport LEDEffect from '../components/LEDEffect';\r\nimport '../css/AIAssistantPage.css';\r\nimport API_HOST from '../utils/apiHost';\r\n\r\nconst AIAssistantPage = () => {\r\n\tconst [messages, setMessages] = useState([]);\r\n\tconst [inputMessage, setInputMessage] = useState('');\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [showQuickActions, setShowQuickActions] = useState(true);\r\n\tconst [aiModel, setAiModel] = useState('gpt-4o');\r\n\tconst [conversationContext, setConversationContext] = useState([]);\r\n\t\r\n\tconst messagesEndRef = useRef(null);\r\n\tconst textareaRef = useRef(null);\r\n\tconst navigate = useNavigate();\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tmessagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tif (messages.length > 0) {\r\n\t\t\tscrollToBottom();\r\n\t\t}\r\n\t}, [messages]);\r\n\r\n\t// Auto-resize textarea\r\n\tuseEffect(() => {\r\n\t\tif (textareaRef.current) {\r\n\t\t\ttextareaRef.current.style.height = 'auto';\r\n\t\t\ttextareaRef.current.style.height = Math.min(textareaRef.current.scrollHeight, 200) + 'px';\r\n\t\t}\r\n\t}, [inputMessage]);\r\n\r\n\tconst quickPrompts = [\r\n\t\t'Storia: Seconda Guerra Mondiale',\r\n\t\t'Matematica: Equazioni di secondo grado',\r\n\t\t'Geografia: Capitali europee',\r\n\t\t'Biologia: Corpo umano'\r\n\t];\r\n\r\n\tconst handleSendMessage = async (text = inputMessage) => {\r\n\t\tif (!text || text.trim().length === 0 || isLoading) return;\r\n\r\n\t\tconst userMessage = {\r\n\t\t\trole: 'user',\r\n\t\t\tcontent: text.trim(),\r\n\t\t\ttimestamp: new Date()\r\n\t\t};\r\n\r\n\t\tsetMessages(prev => [...prev, userMessage]);\r\n\t\tconst newContext = [...conversationContext, { role: 'user', content: text.trim() }];\r\n\t\tsetConversationContext(newContext);\r\n\t\tsetInputMessage('');\r\n\t\tsetIsLoading(true);\r\n\t\tsetShowQuickActions(false);\r\n\r\n\t\t// Crea messaggio assistant vuoto per streaming\r\n\t\tconst assistantMessageId = Date.now();\r\n\t\tconst initialAssistantMessage = {\r\n\t\t\tid: assistantMessageId,\r\n\t\t\trole: 'assistant',\r\n\t\t\tcontent: '',\r\n\t\t\ttimestamp: new Date(),\r\n\t\t\tisStreaming: true\r\n\t\t};\r\n\t\tsetMessages(prev => [...prev, initialAssistantMessage]);\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(`${API_HOST}/ai-assistant/stream`, {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t\tcredentials: 'include',\r\n\t\t\t\tbody: JSON.stringify({ \r\n\t\t\t\t\tprompt: text.trim(),\r\n\t\t\t\t\tmodel: aiModel,\r\n\t\t\t\t\tconversationHistory: newContext.slice(-10)\r\n\t\t\t\t})\r\n\t\t\t});\r\n\r\n\t\t\tif (res.status === 401) {\r\n\t\t\t\twindow.location.href = '/#/';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!res.ok) {\r\n\t\t\t\tthrow new Error(`HTTP error! status: ${res.status}`);\r\n\t\t\t}\r\n\r\n\t\t\t// Leggi stream\r\n\t\t\tconst reader = res.body.getReader();\r\n\t\t\tconst decoder = new TextDecoder();\r\n\t\t\tlet streamedContent = '';\r\n\t\t\tlet testData = null;\r\n\r\n\t\t\twhile (true) {\r\n\t\t\t\tconst { value, done } = await reader.read();\r\n\t\t\t\tif (done) break;\r\n\r\n\t\t\t\tconst chunk = decoder.decode(value, { stream: true });\r\n\t\t\t\tconst lines = chunk.split('\\n');\r\n\r\n\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\tif (line.startsWith('data: ')) {\r\n\t\t\t\t\t\tconst data = line.slice(6);\r\n\t\t\t\t\t\tif (data === '[DONE]') continue;\r\n\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst parsed = JSON.parse(data);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (parsed.content) {\r\n\t\t\t\t\t\t\t\tstreamedContent += parsed.content;\r\n\t\t\t\t\t\t\t\tsetMessages(prev => prev.map(msg => \r\n\t\t\t\t\t\t\t\t\tmsg.id === assistantMessageId \r\n\t\t\t\t\t\t\t\t\t\t? { ...msg, content: streamedContent }\r\n\t\t\t\t\t\t\t\t\t\t: msg\r\n\t\t\t\t\t\t\t\t));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (parsed.testGenerated) {\r\n\t\t\t\t\t\t\t\ttestData = parsed.testData;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (parsed.error) {\r\n\t\t\t\t\t\t\t\tthrow new Error(parsed.error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tconsole.warn('Parse error:', e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Finalizza messaggio\r\n\t\t\tsetMessages(prev => prev.map(msg => \r\n\t\t\t\tmsg.id === assistantMessageId \r\n\t\t\t\t\t? { \r\n\t\t\t\t\t\t...msg, \r\n\t\t\t\t\t\tisStreaming: false,\r\n\t\t\t\t\t\ttestGenerated: !!testData,\r\n\t\t\t\t\t\ttestArea: testData?.thematicArea\r\n\t\t\t\t\t}\r\n\t\t\t\t\t: msg\r\n\t\t\t));\r\n\r\n\t\t\t// Aggiorna context\r\n\t\t\tsetConversationContext(prev => [...prev, { role: 'assistant', content: streamedContent }]);\r\n\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('‚ùå Errore AI:', err);\r\n\t\t\tsetMessages(prev => prev.map(msg => \r\n\t\t\t\tmsg.id === assistantMessageId \r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t...msg,\r\n\t\t\t\t\t\tcontent: `‚ùå Errore: ${err.message || 'Connessione fallita'}\\n\\nProva a:\\n‚Ä¢ Verificare la connessione\\n‚Ä¢ Riformulare la richiesta\\n‚Ä¢ Ridurre la lunghezza del messaggio`,\r\n\t\t\t\t\t\tisStreaming: false,\r\n\t\t\t\t\t\tisError: true\r\n\t\t\t\t\t}\r\n\t\t\t\t\t: msg\r\n\t\t\t));\r\n\t\t} finally {\r\n\t\t\tsetIsLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleKeyPress = (e) => {\r\n\t\tif (e.key === 'Enter' && !e.shiftKey) {\r\n\t\t\te.preventDefault();\r\n\t\t\thandleSendMessage();\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleQuickPrompt = (prompt) => {\r\n\t\tsetInputMessage(prompt);\r\n\t\thandleSendMessage(prompt);\r\n\t};\r\n\r\n\tconst clearChat = () => {\r\n\t\tif (window.confirm('Vuoi cancellare tutta la cronologia della chat?')) {\r\n\t\t\tsetMessages([]);\r\n\t\t\tsetConversationContext([]);\r\n\t\t\tsetShowQuickActions(true);\r\n\t\t}\r\n\t};\r\n\r\n\tconst copyMessage = (content) => {\r\n\t\tnavigator.clipboard.writeText(content);\r\n\t};\r\n\r\n\tconst regenerateResponse = async (messageIndex) => {\r\n\t\tif (messageIndex < 1) return;\r\n\t\tconst userMsg = messages[messageIndex - 1];\r\n\t\tif (userMsg.role !== 'user') return;\r\n\r\n\t\t// Rimuovi messaggi dopo quello da rigenerare\r\n\t\tsetMessages(prev => prev.slice(0, messageIndex));\r\n\t\tsetConversationContext(prev => prev.slice(0, messageIndex));\r\n\t\t\r\n\t\t// Rigenera\r\n\t\thandleSendMessage(userMsg.content);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"ai-assistant-page\">\r\n\t\t\t<PageBackground />\r\n\t\t\t<LEDEffect variant=\"floating\" color=\"purple\" />\r\n\t\t\t<Topbar />\r\n\t\t\t<div className=\"ai-container\">\r\n\t\t\t\t<div className=\"ai-header\">\r\n\t\t\t\t\t<h1>AI Assistant</h1>\r\n\t\t\t\t\t<button \r\n\t\t\t\t\t\tclassName=\"clear-btn\"\r\n\t\t\t\t\t\tonClick={clearChat}\r\n\t\t\t\t\t\tdisabled={messages.length === 0}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tClear\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"chat-container\">\r\n\t\t\t\t\t<div className=\"messages-area\">\r\n\t\t\t\t\t\t{messages.map((msg, idx) => (\r\n\t\t\t\t\t\t\t<div key={idx} className={`message ${msg.role} ${msg.isError ? 'error' : ''}`}>\r\n\t\t\t\t\t\t\t\t<div className=\"message-content\">\r\n\t\t\t\t\t\t\t\t\t{msg.content}\r\n\t\t\t\t\t\t\t\t\t{msg.isStreaming && <span className=\"cursor\">|</span>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{msg.role === 'assistant' && !msg.isStreaming && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"message-actions\">\r\n\t\t\t\t\t\t\t\t\t\t<button onClick={() => copyMessage(msg.content)}>\r\n\t\t\t\t\t\t\t\t\t\t\tCopy\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<button onClick={() => regenerateResponse(idx)}>\r\n\t\t\t\t\t\t\t\t\t\t\tRegenerate\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{msg.testGenerated && (\r\n\t\t\t\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\t\t\t\tclassName=\"test-btn\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => navigate('/dashboard')}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tView Test\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t{isLoading && (\r\n\t\t\t\t\t\t\t<div className=\"message assistant\">\r\n\t\t\t\t\t\t\t\t<div className=\"message-content\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"typing\">\r\n\t\t\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div ref={messagesEndRef} />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{showQuickActions && messages.length === 0 && (\r\n\t\t\t\t\t\t<div className=\"suggestions\">\r\n\t\t\t\t\t\t\t{quickPrompts.slice(0, 4).map((prompt, idx) => (\r\n\t\t\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\t\t\t\tclassName=\"suggestion\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => handleQuickPrompt(prompt)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{prompt}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<div className=\"input-area\">\r\n\t\t\t\t\t\t<select \r\n\t\t\t\t\t\t\tvalue={aiModel} \r\n\t\t\t\t\t\t\tonChange={(e) => setAiModel(e.target.value)}\r\n\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"gpt-4o\">GPT-4o</option>\r\n\t\t\t\t\t\t\t<option value=\"gpt-4o-mini\">GPT-4o Mini</option>\r\n\t\t\t\t\t\t\t<option value=\"o1-preview\">O1 Preview</option>\r\n\t\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\tref={textareaRef}\r\n\t\t\t\t\t\t\tplaceholder=\"Message AI...\"\r\n\t\t\t\t\t\t\tvalue={inputMessage}\r\n\t\t\t\t\t\t\tonChange={(e) => setInputMessage(e.target.value)}\r\n\t\t\t\t\t\t\tonKeyPress={handleKeyPress}\r\n\t\t\t\t\t\t\trows={1}\r\n\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\tclassName=\"send-btn\"\r\n\t\t\t\t\t\t\tonClick={() => handleSendMessage()}\r\n\t\t\t\t\t\t\tdisabled={isLoading || !inputMessage.trim()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{isLoading ? '...' : '‚Üí'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AIAssistantPage;\r\n","import { memo } from 'react';\r\n\r\nconst PageBackground = memo(() => (\r\n  <div className=\"page-bg-wrapper\" aria-hidden=\"true\">\r\n    <img className=\"page-bg\" src={process.env.PUBLIC_URL + '/sfondo_pages.jpg'} alt=\"\" loading=\"lazy\" />\r\n  </div>\r\n));\r\n\r\nPageBackground.displayName = 'PageBackground';\r\n\r\nexport default PageBackground;\r\n","import { memo, useCallback } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useTheme } from '../utils/themeContext';\r\nimport LanguageSelector from './LanguageSelector';\r\nimport '../css/Topbar.css';\r\n\r\nconst Topbar = memo(() => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { theme, toggleTheme } = useTheme();\r\n  const { t } = useTranslation();\r\n  \r\n  const isActive = (path) => location.pathname === path || location.pathname.startsWith(path);\r\n  \r\n  return (\r\n    <div className=\"dashboard-topbar\">\r\n      <button \r\n        className={`topbar-btn${isActive('/dashboard') ? ' active' : ''}`} \r\n        onClick={() => navigate('/dashboard')}\r\n      >\r\n        {t('topbar.home')}\r\n      </button>\r\n      <button \r\n        className={`topbar-btn${isActive('/ai-assistant') ? ' active' : ''}`} \r\n        onClick={() => navigate('/ai-assistant')}\r\n      >\r\n        {t('topbar.aiAssistant')}\r\n      </button>\r\n      <button \r\n        className={`topbar-btn${isActive('/statistiche') ? ' active' : ''}`} \r\n        onClick={() => navigate('/statistiche')}\r\n      >\r\n        {t('topbar.statistics')}\r\n      </button>\r\n      \r\n      <LanguageSelector />\r\n      \r\n      <button \r\n        className=\"theme-toggle-btn\"\r\n        onClick={toggleTheme}\r\n        aria-label={t('landing.changeTheme')}\r\n        title={theme === 'light' ? t('landing.darkTheme') : t('landing.lightTheme')}\r\n      >\r\n        {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}\r\n      </button>\r\n    </div>\r\n  );\r\n});\r\n\r\nTopbar.displayName = 'Topbar';\r\n\r\nexport default Topbar;\r\n","import React from 'react';\r\nimport '../css/LEDEffect.css';\r\n\r\nexport default function LEDEffect({ variant = 'corner', color = 'blue' }) {\r\n  const renderCornerLEDs = () => (\r\n    <>\r\n      <div className={`led-corner led-top-left led-${color}`}>\r\n        <div className=\"led-dot\"></div>\r\n        <div className=\"led-line led-line-horizontal\"></div>\r\n        <div className=\"led-line led-line-vertical\"></div>\r\n      </div>\r\n      <div className={`led-corner led-top-right led-${color}`}>\r\n        <div className=\"led-dot\"></div>\r\n        <div className=\"led-line led-line-horizontal\"></div>\r\n        <div className=\"led-line led-line-vertical\"></div>\r\n      </div>\r\n      <div className={`led-corner led-bottom-left led-${color}`}>\r\n        <div className=\"led-dot\"></div>\r\n        <div className=\"led-line led-line-horizontal\"></div>\r\n        <div className=\"led-line led-line-vertical\"></div>\r\n      </div>\r\n      <div className={`led-corner led-bottom-right led-${color}`}>\r\n        <div className=\"led-dot\"></div>\r\n        <div className=\"led-line led-line-horizontal\"></div>\r\n        <div className=\"led-line led-line-vertical\"></div>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  const renderFloatingLEDs = () => (\r\n    <>\r\n      <div className={`led-floating led-float-1 led-${color}`}></div>\r\n      <div className={`led-floating led-float-2 led-${color}`}></div>\r\n      <div className={`led-floating led-float-3 led-${color}`}></div>\r\n      <div className={`led-floating led-float-4 led-${color}`}></div>\r\n      <div className={`led-floating led-float-5 led-${color}`}></div>\r\n    </>\r\n  );\r\n\r\n  const renderBorderTrace = () => (\r\n    <div className={`led-border-container led-${color}`}>\r\n      <svg className=\"led-border-svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\">\r\n        <defs>\r\n          <linearGradient id={`ledGrad-${color}`} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n            <stop offset=\"0%\" stopColor=\"currentColor\" stopOpacity=\"0\">\r\n              <animate attributeName=\"stop-opacity\" values=\"0;0.8;0\" dur=\"3s\" repeatCount=\"indefinite\" />\r\n            </stop>\r\n            <stop offset=\"50%\" stopColor=\"currentColor\" stopOpacity=\"0.8\">\r\n              <animate attributeName=\"stop-opacity\" values=\"0.3;1;0.3\" dur=\"3s\" repeatCount=\"indefinite\" />\r\n            </stop>\r\n            <stop offset=\"100%\" stopColor=\"currentColor\" stopOpacity=\"0\">\r\n              <animate attributeName=\"stop-opacity\" values=\"0;0.8;0\" dur=\"3s\" repeatCount=\"indefinite\" />\r\n            </stop>\r\n          </linearGradient>\r\n        </defs>\r\n        <rect \r\n          x=\"0\" \r\n          y=\"0\" \r\n          width=\"100\" \r\n          height=\"100\" \r\n          fill=\"none\" \r\n          stroke={`url(#ledGrad-${color})`}\r\n          strokeWidth=\"0.5\"\r\n          className=\"led-border-rect\"\r\n        />\r\n      </svg>\r\n      <div className=\"led-corner-glow led-corner-glow-tl\"></div>\r\n      <div className=\"led-corner-glow led-corner-glow-tr\"></div>\r\n      <div className=\"led-corner-glow led-corner-glow-bl\"></div>\r\n      <div className=\"led-corner-glow led-corner-glow-br\"></div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"led-effect-container\">\r\n      {variant === 'corner' && renderCornerLEDs()}\r\n      {variant === 'floating' && renderFloatingLEDs()}\r\n      {variant === 'border' && renderBorderTrace()}\r\n      {variant === 'full' && (\r\n        <>\r\n          {renderCornerLEDs()}\r\n          {renderFloatingLEDs()}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["AIAssistantPage","messages","setMessages","useState","inputMessage","setInputMessage","isLoading","setIsLoading","showQuickActions","setShowQuickActions","aiModel","setAiModel","conversationContext","setConversationContext","messagesEndRef","useRef","textareaRef","navigate","useNavigate","useEffect","length","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","style","height","Math","min","scrollHeight","handleSendMessage","async","text","arguments","undefined","trim","userMessage","role","content","timestamp","Date","prev","newContext","assistantMessageId","now","initialAssistantMessage","id","isStreaming","res","fetch","concat","API_HOST","method","headers","credentials","body","JSON","stringify","prompt","model","conversationHistory","slice","status","window","location","href","ok","Error","reader","getReader","decoder","TextDecoder","streamedContent","testData","value","done","read","lines","decode","stream","split","line","startsWith","data","parsed","parse","map","msg","_objectSpread","testGenerated","error","e","console","warn","_testData","testArea","thematicArea","err","message","isError","_jsxs","className","children","_jsx","PageBackground","LEDEffect","variant","color","Topbar","onClick","clearChat","confirm","disabled","idx","copyMessage","navigator","clipboard","writeText","messageIndex","userMsg","regenerateResponse","ref","handleQuickPrompt","onChange","target","placeholder","onKeyPress","key","shiftKey","preventDefault","rows","memo","src","alt","loading","displayName","useLocation","theme","toggleTheme","useTheme","t","useTranslation","isActive","path","pathname","LanguageSelector","title","_ref","renderCornerLEDs","_Fragment","renderFloatingLEDs","viewBox","preserveAspectRatio","x1","y1","x2","y2","offset","stopColor","stopOpacity","attributeName","values","dur","repeatCount","x","y","width","fill","stroke","strokeWidth"],"sourceRoot":""}